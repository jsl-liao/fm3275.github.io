<h2><span style="color: rgb(0, 0, 0);">executeSql 函數 step by step, 第 05 章，Having 子句</span></h2><p><span style="color: rgb(0, 0, 0);">利用 </span><span style="color: rgb(0, 0, 0);"><strong>Having</strong></span><span style="color: rgb(0, 0, 0);"> 子句可以為記錄組（ &nbsp;Group ）指定條件，一定是和 Group 子句搭配 一起使用。</span></p><pre><code >Group clause Having expr1 rel_operator expr2</code></pre><p>expr1<span style="color: rgb(51, 51, 51); background-color: rgb(255, 255, 255); font-size: 16px;"> 和 </span>expr2<span style="color: rgb(51, 51, 51); background-color: rgb(255, 255, 255); font-size: 16px;"> 可以是字段名稱、常量值或表達式。這些表達式不必匹配 </span>SELECT<span style="color: rgb(51, 51, 51); background-color: rgb(255, 255, 255); font-size: 16px;"> 子句中的列表達式。</span></p><p>rel_operator<span style="color: rgb(51, 51, 51); background-color: rgb(255, 255, 255); font-size: 16px;"> 是連結兩個表達式的關係運算子。</span></p><p><span style="color: rgb(51, 51, 51); background-color: rgb(255, 255, 255); font-size: 16px;"><strong>Having</strong></span><span style="color: rgb(51, 51, 51); background-color: rgb(255, 255, 255); font-size: 16px;"> 子句和 </span><span style="color: rgb(51, 51, 51); background-color: rgb(255, 255, 255); font-size: 16px;"><strong>Where</strong></span><span style="color: rgb(51, 51, 51); background-color: rgb(255, 255, 255); font-size: 16px;"> 子句的差異：</span></p><p><span style="color: rgb(0, 0, 0);"><strong>Having</strong></span><span style="color: rgb(0, 0, 0);"> 子句後面可以接聚合函數。</span></p><p><span style="color: rgb(0, 0, 0);"><strong>Where</strong></span><span style="color: rgb(0, 0, 0);"> 子句後面接的是一般的比較條件。</span></p><h3 style="text-align: start; line-height: 1.2;">範例 1:</h3><p style="text-align: start;">列出公司家數大於 12 家的縣市, 和公司家數, 組成 &nbsp;json</p><p style="text-align: start;">和第 4 章的範例比較, 只差了 Having 子句</p><pre><code >let (
  ~json = "{\"" & ExecuteSQL ( "Select addrCity , count(id) From Company Group By addrCity Having Count(id) &gt; 12" ; "\":" ; ",\"" ) & "}";
  substitute ( JSONFormatElements ( ~json ) ; char(9) ; "  "))</code></pre><h3 style="text-align: start; line-height: 1.2;">提示:</h3><ol><li style="text-align: start;">為了更容易閱讀和除錯, 可以把計算式依據子句做分段。</li><li style="text-align: start;">子句的順序要如第０章所列出的順序。</li><li style="text-align: start;"></li></ol><pre><code >let (  
  ~json = "{\"" & ExecuteSQL ( "    
    Select addrCity , count(id)     
    From Company     
    Group By addrCity     
    Having Count(id) &gt; 12     
    " ; "\":" ; ",\"" ) & "}";  
  substitute ( JSONFormatElements ( ~json ) ; char(9) ; "  "))</code></pre><p><br></p>