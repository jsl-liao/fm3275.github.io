<h2><span style="color: rgb(0, 0, 0);">executeSql 函數 step by step, 第 06 章，</span>Union 運算子</h2><p>UNION<span style="color: rgb(51, 51, 51); background-color: rgb(250, 250, 250); font-size: 16px;"> 運算子將兩個或多個 </span>SELECT<span style="color: rgb(51, 51, 51); background-color: rgb(250, 250, 250); font-size: 16px;"> 語句的結果合併為一個結果。</span></p><p><span style="color: rgb(51, 51, 51); background-color: rgb(250, 250, 250); font-size: 16px;">結果是 </span>SELECT<span style="color: rgb(51, 51, 51); background-color: rgb(250, 250, 250); font-size: 16px;"> 語句返回的所有記錄。</span></p><p><span style="color: rgb(51, 51, 51); background-color: rgb(250, 250, 250); font-size: 16px;">默認情況下，不返回重複的記錄。</span></p><p><span style="color: rgb(51, 51, 51); background-color: rgb(250, 250, 250); font-size: 16px;">要返回重複的記錄，使用 </span>ALL<span style="color: rgb(51, 51, 51); background-color: rgb(250, 250, 250); font-size: 16px;"> 關鍵字 (</span>UNION ALL<span style="color: rgb(51, 51, 51); background-color: rgb(250, 250, 250); font-size: 16px;">)。</span></p><p><span style="color: rgb(51, 51, 51); background-color: rgb(250, 250, 250); font-size: 16px;">格式為：</span></p><pre><code >SELECT statement UNION [ALL] SELECT statement</code></pre><p><span style="color: rgb(51, 51, 51); background-color: rgb(250, 250, 250); font-size: 16px;">使用 </span>UNION<span style="color: rgb(51, 51, 51); background-color: rgb(250, 250, 250); font-size: 16px;"> 運算子時，</span></p><ol><li><span style="color: rgb(51, 51, 51); background-color: rgb(250, 250, 250); font-size: 16px;">每個 </span>SELECT<span style="color: rgb(51, 51, 51); background-color: rgb(250, 250, 250); font-size: 16px;"> 語句的選擇列表必須具有相同數量的列(field, 欄位)表達式，</span></li><li><span style="color: rgb(51, 51, 51); background-color: rgb(250, 250, 250); font-size: 16px;">以及相同的數據類型，</span></li><li><span style="color: rgb(51, 51, 51); background-color: rgb(250, 250, 250); font-size: 16px;">並且必須按相同的順序指定。</span></li></ol><h3>範例： 1</h3><p>取得花蓮縣，台東縣的公司名</p><pre><code >ExecuteSQL ( "
Select name , addrCity From Company Where addrCity = ?
Union 
Select name , addrCity From Company Where addrCity = ?
" ; "" ; "" ; "花蓮縣" ; "台東縣")</code></pre><h4>提示:</h4><ol><li>對同一個表也可以使用 <strong>Union</strong> 運算子。</li><li>所得的結果，資料的先後順序並不是先花蓮縣再接著台東縣的公司，而是混在一起，由 sql 演算法所決定。</li></ol><p>另一種寫法</p><pre><code >ExecuteSQL ( "Select name , addrCity From Company Where addrCity = ? Or addrCity = ?" ; "" ; "" ; "花蓮縣" ; "台東縣")</code></pre><p><span style="color: rgb(0, 0, 0);">提示:</span></p><p><span style="color: rgb(0, 0, 0);">和上一種寫法比較，資料的排列順序不同，內含是相同的。如果把兩者 sortValues 可以得到相同的結果。</span></p><h3><span style="color: rgb(0, 0, 0);">範例：2</span></h3><p><span style="color: rgb(0, 0, 0);">把不同的表的查詢結果 </span><span style="color: rgb(0, 0, 0);"><strong>Union</strong></span><span style="color: rgb(0, 0, 0);"> 起來</span></p><pre><code >ExecuteSQL ( "
Select name , addrCity, addrStr From company Where addrCity = ?
Union 
Select addrStr, addrCity, name From contact Where addrCity = ?
 Order By name
" ; "" ; "" ; "花蓮縣" ; "台東縣")</code></pre><p><span style="color: rgb(0, 0, 0);">提示:</span></p><ol><li><span style="color: rgb(0, 0, 0);">sql 會檢查 columns 數量是否相同，依據順序的對應的資料類別是否相同，不管邏輯上的意義。</span></li><li><span style="color: rgb(0, 0, 0);">例子中的計算會組成以三個 column 組成 value 的 value list。 </span></li><li><span style="color: rgb(0, 0, 0);">對 </span><span style="color: rgb(0, 0, 0);"><strong>Union</strong></span><span style="color: rgb(0, 0, 0);"> 之後的資料做排序，Order 子句要寫在 </span><span style="color: rgb(0, 0, 0);"><strong>Union</strong></span><span style="color: rgb(0, 0, 0);"> 後面。</span></li><li><span style="color: rgb(0, 0, 0);">排序所依據的順序是按照第一個 Select 敘述中的 column name。</span></li></ol>