<h2>executeSql 函數 step by step, 第 41 章，sql 保留字</h2>
<p>
為了避免在應用 executeSql 函數發生錯誤，在為表和欄位命名必須避免使用 sql 保留字。</p>
<p>以下是檢驗&nbsp;<span style="caret-color: rgb(0, 0, 0); font-weight: normal; -webkit-text-size-adjust: auto; text-decoration: none">表名稱和欄位名稱的 custom function</span></p>
<p>詳細內容在 custom function 的 folder 中的 cf_chkNamesBySql 和&nbsp;<span style="caret-color: rgb(0, 0, 0); font-weight: normal; text-align: left; -webkit-text-size-adjust: auto; text-decoration: none">co_sqlWords</span></p>
<p><div class="dp-highlighter"><div class="bar"></div><ol start="1" class="dp-sql"><li class="alt"><span><span>Let&nbsp;(&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;[&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;~baseTableNameList&nbsp;=&nbsp;ExecuteSQL&nbsp;(<span class="string">"SELECT&nbsp;BaseTableName&nbsp;FROM&nbsp;FileMaker_Tables"</span><span>&nbsp;;&nbsp;</span><span class="string">""</span><span>&nbsp;;&nbsp;</span><span class="string">""</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;~baseTableNameList&nbsp;=&nbsp;UniqueValues&nbsp;(&nbsp;~baseTableNameList&nbsp;);&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;~tableNameList&nbsp;=&nbsp;ExecuteSQL&nbsp;(<span class="string">"SELECT&nbsp;tableName&nbsp;FROM&nbsp;FileMaker_Tables"</span><span>&nbsp;;&nbsp;</span><span class="string">""</span><span>&nbsp;;&nbsp;</span><span class="string">""</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;~sqlWordList&nbsp;=&nbsp;JSONListValues&nbsp;(&nbsp;co_sqlWords;&nbsp;<span class="string">"."</span><span>);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;~tableNameCheck&nbsp;=&nbsp;FilterValues&nbsp;(&nbsp;~tableNameList&nbsp;;&nbsp;~sqlWordList&nbsp;);&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;~tableNameCheck&nbsp;=&nbsp;If&nbsp;(&nbsp;IsEmpty(~tableNameCheck)&nbsp;;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"table&nbsp;name&nbsp;check:&nbsp;no&nbsp;violation&nbsp;found"</span><span>;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"table&nbsp;name&nbsp;check:"</span><span>&nbsp;&amp;&nbsp;¶&nbsp;&amp;&nbsp;FilterValues&nbsp;(&nbsp;~tableNameList&nbsp;;&nbsp;~sqlWordList&nbsp;));&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;~fieldNameCheck&nbsp;=&nbsp;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;While&nbsp;(&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~i&nbsp;=&nbsp;1&nbsp;;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~<span class="keyword">end</span><span>&nbsp;=&nbsp;ValueCount&nbsp;(&nbsp;~baseTableNameList&nbsp;);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~result&nbsp;=&nbsp;<span class="string">""</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;];&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~i&nbsp;&lt;=&nbsp;~<span class="keyword">end</span><span>&nbsp;;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~baseTableName&nbsp;=&nbsp;GetValue&nbsp;(&nbsp;~baseTableNameList&nbsp;;&nbsp;~i&nbsp;);&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~fieldNameList&nbsp;=&nbsp;ExecuteSQL&nbsp;(&nbsp;<span class="string">"Select&nbsp;fieldName&nbsp;from&nbsp;filemaker_fields&nbsp;Where&nbsp;tablename&nbsp;=?"</span><span>&nbsp;;&nbsp;</span><span class="string">""</span><span>&nbsp;;&nbsp;</span><span class="string">""</span><span>&nbsp;;&nbsp;~baseTableName&nbsp;);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~fieldCheck&nbsp;=&nbsp;FilterValues&nbsp;(&nbsp;~fieldNameList&nbsp;;&nbsp;~sqlWordList&nbsp;)&nbsp;;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~fieldCheck&nbsp;=&nbsp;If&nbsp;(&nbsp;IsEmpty(~fieldCheck)&nbsp;;&nbsp;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"field&nbsp;name&nbsp;check&nbsp;on&nbsp;table&nbsp;«&nbsp;"</span><span>&nbsp;&amp;&nbsp;~baseTableName&nbsp;&amp;&nbsp;</span><span class="string">"&nbsp;»:&nbsp;no&nbsp;violation&nbsp;found"</span><span>&nbsp;;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"field&nbsp;name&nbsp;check&nbsp;on&nbsp;table&nbsp;«&nbsp;"</span><span>&nbsp;&amp;&nbsp;~baseTableName&nbsp;&amp;&nbsp;</span><span class="string">"&nbsp;»:&nbsp;violation&nbsp;found&nbsp;as&nbsp;below,¶"</span><span>&nbsp;&amp;&nbsp;~fieldCheck&nbsp;);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~result&nbsp;=&nbsp;~result&nbsp;&amp;&nbsp;~fieldCheck&nbsp;;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~i&nbsp;=&nbsp;~i&nbsp;+&nbsp;1&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;];&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~result&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;];&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;~tableNameCheck&nbsp;&amp;&nbsp;¶&nbsp;&amp;&nbsp;~fieldNameCheck&nbsp;&nbsp;</span></li><li class="alt"><span>)&nbsp;&nbsp;</span></li></ol></div></p>