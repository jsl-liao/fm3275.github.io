<h2 style="text-align: start;">executeSql 函數 step by step, 第 38 章，日期、時間、時間戳函數</h2><table style="width: auto; text-align: start;"><tbody><tr><th colspan="1" rowspan="1" width="auto">函數名稱</th><th colspan="1" rowspan="1" width="auto">說明</th><th colspan="1" rowspan="1" width="auto">返回值</th><th colspan="1" rowspan="1" width="auto">相當 FileMake 函數</th></tr><tr><td colspan="1" rowspan="1" width="auto">CurDate 或 <br>Current_Date</td><td colspan="1" rowspan="1" width="auto">返回今天的日期。</td><td colspan="1" rowspan="1" width="auto">日期</td><td colspan="1" rowspan="1" width="auto">get(currentDate)</td></tr><tr><td colspan="1" rowspan="1" width="auto">CurTime 或 <br>Current_Time</td><td colspan="1" rowspan="1" width="auto">返回當前時間。</td><td colspan="1" rowspan="1" width="auto">日期</td><td colspan="1" rowspan="1" width="auto">get(currentTime)</td></tr><tr><td colspan="1" rowspan="1" width="auto">CurTimestamp 或 <br>Current_Timestamp</td><td colspan="1" rowspan="1" width="auto">返回當前系統時間戳。</td><td colspan="1" rowspan="1" width="auto">時間戳</td><td colspan="1" rowspan="1" width="auto">get(currentTimestamp)</td></tr><tr><td colspan="1" rowspan="1" width="auto">DateVal</td><td colspan="1" rowspan="1" width="auto">將字串轉換為日期。</td><td colspan="1" rowspan="1" width="auto">日期</td><td colspan="1" rowspan="1" width="auto">getAsDate</td></tr><tr><td colspan="1" rowspan="1" width="auto">Day</td><td colspan="1" rowspan="1" width="auto">返回日期或時間戳數據中日的部份。</td><td colspan="1" rowspan="1" width="auto">數字</td><td colspan="1" rowspan="1" width="auto">day</td></tr><tr><td colspan="1" rowspan="1" width="auto">DayOfWeek</td><td colspan="1" rowspan="1" width="auto">返回日期表達式的星期幾 (1-7)<br>星期日（1) ~星期六（7）</td><td colspan="1" rowspan="1" width="auto">數字</td><td colspan="1" rowspan="1" width="auto">DayOfWeek</td></tr><tr><td colspan="1" rowspan="1" width="auto">Hour</td><td colspan="1" rowspan="1" width="auto">返回時間或時間戳數據中小時的部份</td><td colspan="1" rowspan="1" width="auto">數字</td><td colspan="1" rowspan="1" width="auto">Hour</td></tr><tr><td colspan="1" rowspan="1" width="auto">Minute</td><td colspan="1" rowspan="1" width="auto">返回時間或時間戳數據中分的部份</td><td colspan="1" rowspan="1" width="auto">數字</td><td colspan="1" rowspan="1" width="auto">Minute</td></tr><tr><td colspan="1" rowspan="1" width="auto">Month</td><td colspan="1" rowspan="1" width="auto">返回日期或時間戳數據中月的部份。</td><td colspan="1" rowspan="1" width="auto">數字</td><td colspan="1" rowspan="1" width="auto">Month</td></tr><tr><td colspan="1" rowspan="1" width="auto">Second</td><td colspan="1" rowspan="1" width="auto">返回時間或時間戳數據中秒的部份</td><td colspan="1" rowspan="1" width="auto">數字</td><td colspan="1" rowspan="1" width="auto">Seconds</td></tr><tr><td colspan="1" rowspan="1" width="auto">TimestampVal</td><td colspan="1" rowspan="1" width="auto">將字串轉換為時間戳。</td><td colspan="1" rowspan="1" width="auto">時間戳</td><td colspan="1" rowspan="1" width="auto">getAsTimestamp</td></tr><tr><td colspan="1" rowspan="1" width="auto">Today</td><td colspan="1" rowspan="1" width="auto">返回今天的日期。</td><td colspan="1" rowspan="1" width="auto">日期</td><td colspan="1" rowspan="1" width="auto">get(currentDate)</td></tr><tr><td colspan="1" rowspan="1" width="auto">TimeVal</td><td colspan="1" rowspan="1" width="auto">以字符串的形式返回当天的时间</td><td colspan="1" rowspan="1" width="auto">文字</td><td colspan="1" rowspan="1" width="auto"></td></tr><tr><td colspan="1" rowspan="1" width="auto">Year</td><td colspan="1" rowspan="1" width="auto">返回日期或時間戳數據中年的部份。</td><td colspan="1" rowspan="1" width="auto">數字</td><td colspan="1" rowspan="1" width="auto">Year</td></tr></tbody></table><ul><li>executeSql 接受 ‘yyyy/mm/dd’ 的日期格式，但返回值永遠都是 ‘yyyy-mm-dd’ 的格式。</li></ul><p><span style="color: rgb(0, 0, 0);">executeSql 接受 timestamp 'yyyy/mm/dd hh:mm:ss' 的時間戳格式，但返回值永遠都是 ‘yyyy-mm-dd hh:mm:ss' 的格式。</span></p><ul><li>FileMaker 也接受 <span style="color: rgb(0, 0, 0);"> yyyy-mm-dd 的日期格式，但返回值永遠都是 yyyy/mm/dd 的格式。</span></li></ul><p><span style="color: rgb(0, 0, 0);">executeSql 接受 yyyy-mm-dd hh:mm:ss 的時間戳格式，但返回值永遠都是 ‘yyyy/mm/dd hh:mm:ss' 的格式。</span></p><ul><li><span style="color: rgb(0, 0, 0);">CurDate 或 Current_Date, CurTime 或 Current_Time, &nbsp;Today 後面不加小括號。</span></li></ul><h3 style="text-align: start;">範例 1 ：</h3><p style="text-align: start;">這兩種寫法，是相同的結果。</p><pre style="text-align: start;"><code>ExecuteSQL ( "Select Date '2024/01/08' - 10 From oneRecord";"";"")
ExecuteSQL ( "Select DateVal('2024/01/08') - 10 From oneRecord";"";"")</code></pre><h3 style="text-align: start;">範例 2 ：</h3><p style="text-align: start;">這兩種寫法，是相同的結果。</p><pre style="text-align: start;"><code>ExecuteSQL ( "Select Time '14:14:14' - 3600 From oneRecord";"";"")
ExecuteSQL ( "Select TimeVal('14:14:14') - 3600 From oneRecord";"";"")</code></pre><h3><span style="color: rgb(0, 0, 0);">範例 3 ：</span></h3><p><span style="color: rgb(0, 0, 0);">這兩種寫法，是相同的結果。</span></p><pre><code >ExecuteSQL ( "Select timestamp '2024/01/08 14:14:14' - 86400 From oneRecord";"";"")
ExecuteSQL ( "Select timestampVal('2024/01/08 14:14:14') - 86400 From oneRecord";"";"")</code></pre><h3><span style="color: rgb(0, 0, 0);">範例 4 ：</span></h3><p>這相當於 24240108141414 - 86400，而不是以時間戳運算。</p><pre><code >ExecuteSQL ( "Select '2024/01/08 14:14:14' - 86400 From oneRecord";"";"")</code></pre><p><br></p>