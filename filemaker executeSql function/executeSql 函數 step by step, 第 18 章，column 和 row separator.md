<h2 style="text-align: start;"><span style="color: rgb(0, 0, 0);">executeSql 函數 step by step, 第 18 章，column 和 row separator</span></h2><p>column separator，也可以稱為 field separator</p><p>row separator, 也可以稱為 record separator</p><p>separator 的作用</p><ul><li>產生特定格式資料。</li><li>透過設定可以產生如：string, json, html, csv(內定 separator 產生的格式 common separate value)...</li><li>如果取值的資料中有“,“ 或 ¶，可以用 separator 加以處理，避免錯誤的資料處理，導致錯誤的結果。</li></ul><h3>範例：1</h3><p><span style="color: rgb(0, 0, 0);">產生 json data</span></p><pre><code >let (  ~json = "{\"" & ExecuteSQL ( "Select addrCity , count(id) From Company Group By addrCity" ; "\":" ; ",\"" ) & "}";  
substitute ( JSONFormatElements ( ~json ) ; char(9) ; "  "))</code></pre><h3>範例: 2</h3><p style="text-align: start;">如果取值的資料中有“,“ 或 ¶，可以用 separator 加以處理。</p><p style="text-align: start;">後續的資料處理可以用 custom function：cf_strByDiv處理，<a href="https://github.com/jsl-liao/fm3275.github.io/blob/main/custom%20function/cf_strByDiv.calc" target="_blank">cf_strByDiv 在 custom function 的資料夾內</a>。</p><pre><code >ExecuteSQL ( "Select name, addrStr, addrCity From company" ; char(41444) ; char(41445) )</code></pre><h3><span style="color: rgb(0, 0, 0);">範例：3 </span></h3><p style="text-align: start;">各縣市公司數的統計表，改變 ~format 則傳回不同格式的值。</p><p style="text-align: start;">~format 可以是 json, html, tsv 其他則是用內定的 csv 格式。 </p><pre><code >let ([  
~format = "tsv" ;  
~colSep = case ( ~format = "json" ;  "\":" ; ~format = "html" ; "&lt;/span&gt;&lt;span class='qty'&gt;" ;~format = "tsv"; char(9) ; "" );  
~rowSep = case ( ~format = "json" ;  ",\"" ; ~format = "html" ; "&lt;/span&gt;&lt;/p&gt;¶&lt;p class='row'&gt;&lt;span class='city'&gt;" ; ~format = "tsv"; char(10) ; "" );  
~prefix = case ( ~format = "json" ;  "{\"" ; ~format = "html" ; "&lt;p class='row'&gt;&lt;span class='city'&gt;" ; ~format = "tsv"; "" ; "" );  
~tail = case ( ~format = "json" ;  "}" ; ~format = "html" ; "&lt;/span&gt;&lt;/p&gt;" ; ~format = "tsv"; "" ; "" );  
~query = "Select addrCity , count(id) From Company Group By addrCity" ];  
~prefix & ExecuteSQL ( ~query ; ~colSep ; ~rowSep ) & ~tail)</code></pre><p><br></p>