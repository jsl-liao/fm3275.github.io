<h2 style="text-align: start;"><a href="https://github.com/jsl-liao/fm3275.github.io/blob/main/filemaker%20executeSql%20function/executeSql%20%E5%87%BD%E6%95%B8%20step%20by%20step%2C%20%E7%AC%AC%2039%20%E7%AB%A0%EF%BC%8C%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B8.md" target="_blank">executeSql 函數 step by step, 第 39 章，聚合函數</a></h2><table style="width: auto; text-align: start;"><tbody><tr><th colspan="1" rowspan="1" width="auto">函數名稱</th><th colspan="1" rowspan="1" width="auto">說明</th><th colspan="1" rowspan="1" width="auto">返回值</th><th colspan="1" rowspan="1" width="auto">相當 FileMake 函數</th></tr><tr><td colspan="1" rowspan="1" width="auto">Sum</td><td colspan="1" rowspan="1" width="auto">數字欄位表達式中值的總計。</td><td colspan="1" rowspan="1" width="auto">數字</td><td colspan="1" rowspan="1" width="auto"><a href="https://help.claris.com/archive/fm19/zh/pro-help/content/sum.html" target="_blank">sum</a></td></tr><tr><td colspan="1" rowspan="1" width="auto">Avg</td><td colspan="1" rowspan="1" width="auto">數字欄位表達式中值的平均值。</td><td colspan="1" rowspan="1" width="auto">數字</td><td colspan="1" rowspan="1" width="auto"><a href="https://help.claris.com/archive/fm19/zh/pro-help/content/average.html" target="_blank">average</a></td></tr><tr><td colspan="1" rowspan="1" width="auto">Count</td><td colspan="1" rowspan="1" width="auto">欄位表達式中值的數目。</td><td colspan="1" rowspan="1" width="auto">數字</td><td colspan="1" rowspan="1" width="auto"><a href="https://help.claris.com/archive/fm19/zh/pro-help/content/count.html" target="_blank">count</a></td></tr><tr><td colspan="1" rowspan="1" width="auto">Max</td><td colspan="1" rowspan="1" width="auto">欄位表達式中的最大值。</td><td colspan="1" rowspan="1" width="auto">數字</td><td colspan="1" rowspan="1" width="auto"><a href="https://help.claris.com/archive/fm19/zh/pro-help/content/max.html" target="_blank">max</a></td></tr><tr><td colspan="1" rowspan="1" width="auto">Min</td><td colspan="1" rowspan="1" width="auto">欄位表達式中的最小值</td><td colspan="1" rowspan="1" width="auto">數字</td><td colspan="1" rowspan="1" width="auto"><a href="https://help.claris.com/archive/fm19/zh/pro-help/content/min.html" target="_blank">min</a></td></tr></tbody></table><ul><li><span style="color: rgb(0, 0, 0);">聚合函數是配合</span><span style="color: rgb(0, 0, 0);"><strong> Group By</strong></span><span style="color: rgb(0, 0, 0);"> 子句一起使用。</span></li><li><span style="color: rgb(0, 0, 0);">聚合函數不會把 null 的欄位值計入，例外：</span><span style="color: rgb(0, 0, 0);"><strong>count</strong></span><span style="color: rgb(0, 0, 0);"> (*) 取得記錄筆數，不管記錄中的欄位是否為null。</span></li><li><span style="color: rgb(51, 51, 51); background-color: rgb(250, 250, 250); font-size: 16px;">不能將聚合函數作為其他函數的參數。否則，FileMaker 軟體將返回錯誤代碼 8309（“不支持包含聚合函數的表達式”）。</span></li><li><span style="color: rgb(51, 51, 51); background-color: rgb(250, 250, 250); font-size: 16px;">executeSql 強在資料查詢，運算能力不強，如果使用 executeSql 進行複雜，大量數據的運算，需要對效率加以評估。</span></li><li><span style="color: rgb(0, 0, 0);"> executeSql 的資料查詢和</span><span style="color: rgb(51, 51, 51); background-color: rgb(250, 250, 250); font-size: 16px;"> FileMaker 運算處理的適當配合，可以提高運算效率。</span></li><li>文字, 日期, 時間, 時間戳欄位可以做 Max, Min 運算; 但不能做 Avg，Sum運算。</li><li>在敘述中，不是聚合函數的引數的欄位必須是 <strong>Group By </strong>的 key field。</li><li>如果 <strong>Group By</strong> 和 <strong>Order By</strong> 同時存在，<strong>Order By</strong> 子句必須在<strong> Group By</strong> 子句的後面。參考：<a href="https://github.com/jsl-liao/fm3275.github.io/blob/main/filemaker%20executeSql%20function/executeSql%20%E5%87%BD%E6%95%B8%20step%20by%20step%2C%20%E7%AC%AC%200%20%E7%AB%A0.md" target="_blank"><strong>FileMaker 的 executeSql 函數 step by step, 第 0 章</strong></a> 所示的語句的順序。</li><li><span style="color: rgb(0, 0, 0);"><strong>Group By</strong></span><span style="color: rgb(0, 0, 0);"> 會對取出的數據進行排序，依據 </span><span style="color: rgb(0, 0, 0);"><strong>Group By </strong></span><span style="color: rgb(0, 0, 0);">的 key field（ascending）。</span></li><li><span style="color: rgb(0, 0, 0);">可以用 </span><span style="color: rgb(0, 0, 0);"><strong>Order By</strong></span><span style="color: rgb(0, 0, 0);"> 子句修改排序的方式，但是 </span><span style="color: rgb(0, 0, 0);"><strong>Order By</strong></span><span style="color: rgb(0, 0, 0);"> 的 key field 必須是 </span><span style="color: rgb(0, 0, 0);"><strong>Group By </strong></span><span style="color: rgb(0, 0, 0);">的 key field。</span></li></ul><h3>範例 1：</h3><p>addrCity 不是聚合函數 Count 的引數，則必是 Group By 的 key。</p><p>否則會出現錯誤：All non-aggregated column references in the SELECT list and HAVING clause must be in the GROUP BY clause.</p><pre><code >ExecuteSQL ( "
  Select addrCity, count(company.name) 
    From company 
    Group By company.addrCity
  "; ": " ; "" )</code></pre><h3><span style="color: rgb(0, 0, 0);">範例 2：</span></h3><p>用 Order By 子句修改排序</p><pre><code >ExecuteSQL ( "
  Select company.addrCity, company.stroke, count(name) 
    From company 
    Group By company.addrCity, company.stroke 
    Order By company.stroke, company.addrCity
  "; ",  " ; "" )</code></pre><p><br></p>